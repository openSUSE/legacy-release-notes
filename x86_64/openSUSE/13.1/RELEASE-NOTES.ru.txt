Примечания к выпуску openSUSE 13.1

Version: 13.1.10 (2014-01-08)

Авторские права © 2008-2013. Отдельная благодарность Илье Барило за
контроль качества <http://sourcelocalizer.ru>, 2013 Александр Мелентьев
(minton@opensuse.org)

Авторские права © 2013 SUSE LLC

Разрешается копировать, распространять и/или видоизменять этот документ на
условиях Лицензии GNU на Свободную Документацию версии 1.2 или любой более
поздней версии, изданной Free Software Foundation; без неизменяемых
разделов, без текстов, помещаемых на первой странице обложки и без текстов,
помещаемых на последней странице обложки. Копия лицензии включена в виде
файла fdl.txt.

---------------------------------------------------------------------------

1. Разное
2. Установка

    2.1. Подробные сведения об установке

3. Общее

    3.1. Документация openSUSE
    3.2. Удаление модулей YaST
    3.3. UEFI — Unified Extensible Firmware Interface
    3.4. UEFI, GPT и разделы MS-DOS
    3.5. Загрузка в режиме Secure Boot
    3.6. Adobe Reader (acroread) и другие утилиты просмотра PDF

4. Обновление системы

    4.1. Обновление с помощью zypper (dup) требует чистки /etc/fstab
    4.2. Переменная SYSLOG_DAEMON удалена
    4.3. Дубликаты сетевых интерфейсов

5. Технические данные

    5.1. Инициализация видео с KMS (Kernel Mode Setting)
    5.2. Артефакты на экране во время установки с драйвером nouveau
    5.3. Samba версии 4.1
    5.4. Настройка Postfix
    5.5. xinetd: запись в системный журнал
    5.6. Apache версии 2.4
    5.7. tomcat: запись в системный журнал
    5.8. Darktable: Необходимо обновить кэш
    5.9. Locate: замена findutils-locate на mlocate
    5.10. KDE и Bluetooth
    5.11. AppArmor и права доступа
    5.12. Skype
    5.13. AutoYaST

Если вы обновляетесь с более старой версии до этого выпуска openSUSE, см.
предыдущие примечания здесь: http://en.opensuse.org/openSUSE:Release_Notes

Примечания к выпуску охватывают следующие области:

  o Раздел 1, «Разное»: Эти записи автоматически выбраны из openFATE,
    системы управления запросами возможностей (http://features.opensuse.org
    ).

    N/A

  o Раздел 2, «Установка»: Прочтите это, если хотите установить систему «с
    нуля».

  o Раздел 3, «Общее»: Информация, которую должен прочитать каждый.

  o Раздел 4, «Обновление системы»: Проблемы, связанные с обновлением с
    предыдущей версии openSUSE.

  o Раздел 5, «Технические данные»: Этот раздел содержит технические
    изменения и улучшения для опытного пользователя.

1. Разное

N/A

2. Установка

2.1. Подробные сведения об установке

Раздел 3.1, «Документация openSUSE» содержит подробные сведения об
установке.

3. Общее

3.1. Документация openSUSE

В Руководстве для начинающих можно найти пошаговые инструкции по установке,
а также ознакомиться с рабочими столами KDE и Gnome и пакетом LibreOffice.
Помимо этого, описаны базовые темы администрирования (развёртывание и
управление программным обеспечением) и производится первое знакомство с
оболочкой bash.

Документация содержится в /usr/share/doc/manual/opensuse-manuals_ru после
установки пакета opensuse-startup_ru или на сайте http://doc.opensuse.org.

3.2. Удаление модулей YaST

Следующие модули YaST устарели и крайне редко используются:

  o yast2-autofs

  o yast2-dbus-client

  o yast2-dirinstall

  o yast2-fingerprint-reader

  o yast2-irda

  o yast2-mouse

  o yast2-phone-services

  o yast2-power-management

  o yast2-profile-manager

  o yast2-sshd

  o yast2-tv

Главной причиной удаления является стремление снизить затраты на
сопровождение и сконцентрировать внимание на более часто используемых
модулях.

3.3. UEFI — Unified Extensible Firmware Interface

Перед установкой openSUSE на систему, загружающуюся с помощью UEFI (Unified
Extensible Firmware Interface), вам настоятельно рекомендуется проверить
наличие обновлений прошивки, рекомендованных производителем, и в случае их
существования установить такие обновления. Предустановленная Windows 8
является верным признаком того, что ваша система использует UEFI.

Обоснование: Некоторые прошивки UEFI содержат ошибки, приводящие к сбою в
случае записи большого объёма данных в область хранения UEFI. Что
характерно, никто точно не знает, насколько «большой» объём приводит к
такому сбою. openSUSE минимизирует этот риск, записывая минимальный объём
данных, необходимых для загрузки ОС. Под минимальным понимается указание
прошивке UEFI на расположение загрузчика openSUSE. Специальные возможности
ядра Linux, использующие область хранения UEFI для сведений о загрузках и
сбоях (pstore), по умолчанию отключены. Тем не менее, рекомендуется
установить все рекомендованные производителем обновления прошивки.

3.4. UEFI, GPT и разделы MS-DOS

Вместе со спецификацией EFI/UEFI применяется новый способ разметки: GPT
(GUID Partition Table). Он использует глобально уникальные идентификаторы
(128-битные значения в виде 32 шестнадцатеричных цифр) для определения
устройств и типов разделов.

Кроме этого, спецификация UEFI разрешает использование устаревших разделов
MBR (MS-DOS). Загрузчики Linux (ELILO или GRUB2) пытаются автоматически
создать GUID для таких разделов и сохранить изменения в прошивке. Такие
GUID могут часто изменяться, что приводит к перезаписи данных прошивки.
Перезапись состоит из двух разных действий: удаления старой записи и
создания новой записи на замену старой.

В современных прошивках есть сборщик мусора, собирающий удалённые записи и
освобождающий память, зарезервированную под старые записи. Проблема
возникает в случае, когда глючная прошивка не освобождает такие записи; это
может привести к невозможности загрузки системы.

Обходной путь очень прост: конвертируйте устаревший раздел MBR в новый GPT,
чтобы полностью избежать подобных проблем.

3.5. Загрузка в режиме Secure Boot

Это касается только машин с UEFI и включённым режимом безопасной загрузки.

Новая версия shim позволяет загрузиться с включённым Secure Boot большему
числу машин, чем в openSUSE 12.3. Тем не менее, в случае проблем сначала
обновите BIOS до последней версии. Если обновление BIOS не помогает,
сообщите модель своей машины на страницу вики (http://en.opensuse.org/
openSUSE:UEFI). Таким образом мы сможем отследить это перед следующим
выпуском.

3.6. Adobe Reader (acroread) и другие утилиты просмотра PDF

Компания Adobe больше не предоставляет обновлений (безопасности) для Adobe
Reader (acroread). Вследствие этого для защиты пользователей openSUSE пакет
acroread исключён из дистрибутива.

В состав openSUSE входят различные средства просмотра файлов в формате PDF:
Okular, Evince, poppler-tools. Эти программы активно поддерживаются и
получают обновления безопасности от openSUSE и оригинальных авторов.

Более подробную информацию вы можете найти на http://en.opensuse.org/
Adobe_Reader.

4. Обновление системы

4.1. Обновление с помощью zypper (dup) требует чистки /etc/fstab

При обновлении с помощью команды zypper dup (обновление через YaST делает
это автоматически) из файла /etc/fstab следует удалить (если они там есть)
следующие записи:

tmpfs   /dev/shm
devpts  /dev/pts
sysfs   /sys sysfs
proc    /proc proc

Это особенно важно для пользователей Gnome, ибо в противном случае терминал
Gnome выдаст сообщение об ошибке "grantpt failed: Operation not permitted".
Эти точки монтирования управляются systemd и более не должны упоминаться в
файле /etc/fstab.

4.2. Переменная SYSLOG_DAEMON удалена

Переменная SYSLOG_DAEMON была удалена. Ранее она использовалась для выбора
демона syslog. Начиная с openSUSE 12.3, только одна реализация syslog может
быть установлена одновременно, она используется автоматически.

Более подробные сведения приведены на странице руководства syslog(8).

4.3. Дубликаты сетевых интерфейсов

Текущая версия systemd использует новое соглашение для назначения
предсказуемых имён сетевым интерфейсам. В YaST внесены соответствующие
изменения.

Есть сообщения, что в YaST происходит ошибка при переходе со старой схемы
наименования на новую. Если один и тот же сетевой интерфейс имеет два
имени, это значит, что вы тоже подверглись действию данной ошибки. В этом
случае удалите сетевые интерфейсы из /etc/sysconfig/network и используйте
YaST для повторной настройки сети.

Более подробную информацию о предсказуемости имён сетевых интерфейсов вы
можете найти на http://www.freedesktop.org/wiki/Software/systemd/
PredictableNetworkInterfaceNames/.

5. Технические данные

5.1. Инициализация видео с KMS (Kernel Mode Setting)

В openSUSE 11.3 мы перешли на KMS (Kernel Mode Setting) для видеокарт
Intel, ATI и NVIDIA, теперь это поведение по умолчанию. Если у вас при этом
возникают проблемы с поддержкой KMS драйвером (intel, radeon, nouveau),
отключите KMS, добавив nomodeset в строку загрузки ядра. Для постоянного
применения в Grub 2, загрузчике по умолчанию, добавьте это в строку
параметров загрузки ядра по умолчанию GRUB_CMDLINE_LINUX_DEFAULT в файле /
etc/default/grub от имени root и запустите команду терминала

sudo /usr/sbin/grub2-mkconfig --output=/boot/grub2/grub.cfg

для применения изменений. Если вы используете Grub Legacy, добавьте это в
строку параметров ядра в файле /boot/grub/menu.lst. Этот параметр означает,
что соответствующий модуль ядра (intel, radeon, nouveau) будет загружен в
initrd с параметром modeset=0, т.е. с отключённым KMS.

В редких случаях, когда загрузка модуля DRM из initrd является общей
проблемой и не относится к KMS, можно полностью отключить загрузку модуля
DRM в initrd. Для этого установите параметр sysconfig NO_KMS_IN_INITRD в
yes через YaST, это создаст initrd заново. Перезагрузитесь.

На картах Intel без KMS Xserver использует драйвер fbdev (драйвер intel
поддерживает только KMS); в качестве альтернативы для устаревших видеокарт
от Intel существует драйвер «intellegacy» (пакет
xorg-x11-driver-video-intel-legacy), всё ещё поддерживающий UMS (User Mode
Setting). Для его использования отредактируйте файл /etc/X11/xorg.conf.d/
50-device.conf и измените драйвер на intellegacy.

На современных картах ATI отступным вариантом является radeonhd. На картах
NVIDIA без KMS используется драйвер nv (драйвер nouveau поддерживает только
KMS). Обратите внимание, более новые видеокарты от ATI и NVIDIA при
указании параметра загрузки ядра nomodeset будут использовать драйвер
fbdev.

5.2. Артефакты на экране во время установки с драйвером nouveau

На некоторых системах с картами NVIDIA установщик может показывать
артефакты в верхней части экрана из-за проблем с драйвером nouveau. Если вы
заметили такую проблему, отключите модуль ядра nouveau перед запуском
установщика, а потом включите снова после установки/обновления.

Для отключения модуля ядра при загрузке с установочного носителя выберите в
grub пункт «Installation» («Установка») и нажмите «e» для редактирования
параметров. Затем перейдите на строку, начинающуюся с «linux» (или
«linuxefi»), и добавьте в конце brokenmodules=nouveau. Теперь нажмите F10,
чтобы продолжить загрузку с новым параметром. После установки системы вы
можете включить модуль nouveau обратно, отредактировав /etc/modprobe.d/
50-blacklist.conf и удалив запись про nouveau.

5.3. Samba версии 4.1

Samba 4.1, входящая в состав openSUSE 13.1, не поддерживает работу в
качестве контроллера домена Active Directory. Эта функция отключена из-за
отсутствия интеграции с системным компонентом MIT Kerberos.

5.4. Настройка Postfix

В openSUSE 12.3 SuSEconfig.postfix был переименован в /usr/sbin/
config.postfix. Если вы меняете переменные sysconfig в /etc/sysconfig/
postfix или /etc/sysconfig/mail, вы должны вручную запустить /usr/sbin/
config.postfix от имени root.

5.5. xinetd: запись в системный журнал

Новый параметр xinetd по умолчанию меняет целевой журнал с /var/log/
xinetd.log на системный журнал. Это означает, что все сообщения от xinetd
появятся в системном журнале с уровнем уведомления.

Если вы хотите вернуть всё как было, найдите нужный фрагмент в /etc/
xinetd.conf. Шаблон скрипта logrotate для xinetd.log можно найти в /usr/
share/doc/packages/xinetd/logrotate.

5.6. Apache версии 2.4

В Apache 2.4 реализовано множество изменений в конфигурационных файлах.
Более подробные сведения об обновлении с предыдущей версии см. http://
httpd.apache.org/docs/2.4/upgrading.html.

5.7. tomcat: запись в системный журнал

Скрипты запуска tomcat больше не выполняют вывод в /var/log/tomcat/
catalina.out. Все сообщения теперь перенаправляются в системный журнал
через tomcat.service (tomcat-jsvc.service) с уровнем уведомлений.

5.8. Darktable: Необходимо обновить кэш

При обновлении с предыдущей версии до openSUSE 13.1 старый файлы кэша могут
не работать. В этом случае необходимо удалить ~/.cache/darktable/mipmaps.

5.9. Locate: замена findutils-locate на mlocate

Утилита mlocate является заменой findutils-locate. При настройка по
умолчанию mlocate ведёт себя так же, как findutils-locate. Из-за улучшенной
обработки разрешений появление доступа к файлу базы данных у обычных
пользователей может затянуться на сутки.

В случае, если вы получаете сообщение «Permission denied» вскоре после
установки mlocate, запустите

/etc/cron.daily/mlocate.cron

один раз от имени root.

5.10. KDE и Bluetooth

Стек Bluetooth предоставлен Bluez 5 (новой версией без обратной
совместимости), необходимым обновлением для рабочего стола GNOME и
некоторых компонентов базовой системы. К сожалению, выпущенные на данный
момент версии KDE поддерживают только Bluez версии 4.

Вследствие этого команда сообщества openSUSE KDE предлагает неофициальный
пакет Bluedevil, предоставляющий базовые функции: спаривание устройств и
поддержка bluetooth-мышей. Некоторые функции не поддерживаются, например,
пересылка файлов.

На данный момент сообщения об ошибках поддержки Bluetooth в KDE не
принимаются, работа над портированием Bluedevil на Bluez 5 ведётся.

5.11. AppArmor и права доступа

AppArmor включён по умолчанию. Это повышает уровень безопасности, но может
помешать работе нестандартно запускаемых служб. Если у вас возникают
странные проблемы с правами доступа, попробуйте профиль AppArmor для этой
службы в щадящий режим:

aa-complain /usr/bin/$ваша_служба

Щадящий режим означает: разрешить всё, но вести журнал действий, которые
запрещены профилем.

Создайте сообщение об ошибке, если это поможет: мы хотим исправить профили
AppArmor, чтобы они покрывали и крайние случаи.

5.12. Skype

При использовании PulseAudio 4.0 возникает ошибка в текущей версии Skype
для Linux (v4.2). До починки и обновления Skype запускайте его из командной
строки:

PULSE_LATENCY_MSEC=60 skype

Более подробную информацию вы можете найти на http://arunraghavan.net/2013/
08/pulseaudio-4-0-and-skype/.

5.13. AutoYaST

Если в профиле autoyast содержит записи в секции <add-on>, это приводит к
появлению ошибки, препятствующей передаче сведений профиля из первой стадии
во вторую. В этом случае все шаги настройки второй стадии пропускаются, что
в общем случае приводит к полной невозможности использования установленной
системы.

В качестве временного решения не используйте секции <add-on> в профилях
AutoYaST из openSUSE 13.1.

